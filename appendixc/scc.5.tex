\subchapter{Krańce rozkładu dwumianowego}

\exercise %C.5-1
Zanim przejdziemy do porównywania prawdopodobieństw, udowodnimy pomocniczą nierówność
\[
    \binom{4n}{n-1} > 8^n
\]
dla $n\ge20$, stosując indukcję matematyczną.
Przypadek bazowy indukcji można zweryfikować, obliczając wartości obu stron nierówności.
Załóżmy zatem, że $n>20$ i~skorzystajmy z~\refExercise{C.1-5}, a~następnie trzykrotnie z~\refExercise{C.1-6}:
\[
    \binom{4n}{n-1} = \frac{4n}{n-1}\cdot\binom{4n-1}{n-2} = \frac{4n}{n-1}\cdot\frac{4n-1}{3n+1}\cdot\frac{4n-2}{3n}\cdot\frac{4n-3}{3n-1}\cdot\binom{4(n-1)}{n-2}.
\]
Na mocy założenia indukcyjnego zachodzi
\[
    \binom{4n}{n-1} > \frac{(4n)(4n-1)(4n-2)(4n-3)}{(n-1)(3n+1)(3n)(3n-1)}\cdot8^{n-1} = \frac{(4n-1)(2n-1)(4n-3)}{3(n-1)(3n+1)(3n-1)}\cdot8^n.
\]
Okazuje się, że dla $n\ge2$, a~więc w~szczególności dla $n\ge20$ spełnione jest
\[
    \frac{(4n-1)(2n-1)(4n-3)}{3(n-1)(3n+1)(3n-1)} \ge 1,
\]
co dowodzi tezy.

Zdefiniujmy teraz $X$ i~$Y$ jako zmienne losowe przyjmujące liczby uzyskanych orłów, odpowiednio, w~pierwszym i~w~drugim doświadczeniu.
Mamy zatem
\begin{align*}
	\Pr(X=0) &= b(0;n,1/2) = \binom{n}{0}\biggl(\frac{1}{2}\biggr)^0\biggl(\frac{1}{2}\biggr)^n = \biggl(\frac{1}{2}\biggr)^n, \\
	\Pr(Y<n) &= \sum_{i=0}^{n-1}b(i;4n,1/2) = \sum_{i=0}^{n-1}\binom{4n}{i}\biggl(\frac{1}{2}\biggr)^i\biggl(\frac{1}{2}\biggr)^{4n-i} = \biggl(\frac{1}{2}\biggr)^{4n}\sum_{i=0}^{n-1}\binom{4n}{i}.
\end{align*}
Dzięki uprzednio udowodnionej nierówności pokazujemy, że jeśli $n\ge20$, to
\[
    \frac{\Pr(Y<n)}{\Pr(X=0)} = \frac{\bigl(\frac{1}{2}\bigr)^{4n}\sum_{i=0}^{n-1}\binom{4n}{i}}{\bigl(\frac{1}{2}\bigr)^n} = \frac{\sum_{i=0}^{n-1}\binom{4n}{i}}{8^n} > \frac{\binom{4n}{n-1}}{8^n} > 1.
\]
Wartości obu prawdopodobieństw w~przypadku, gdy $n<20$, obliczamy bezpośrednio.
Otrzymujemy ostatecznie, że $\Pr(X=0)>\Pr(Y<n)$, gdy $n\le17$, oraz $\Pr(X=0)<\Pr(Y<n)$ w~przeciwnym przypadku.
A~zatem, dla odpowiednio dużych $n$, prawdopodobieństwo uzyskania mniej niż $n$ orłów w~$4n$ rzutach monetą jest większe niż nieuzyskanie żadnego orła w~$n$ rzutach.

\exercise %C.5-2
\begin{proof}[Dowód wniosku C.6]
	Ponieważ uzyskanie więcej niż $k$ sukcesów w~$n$ próbach jest równoważne uzyskaniu mniej niż $n-k$ porażek, to zachodzi $\Pr(X>k)=\Pr(Y<n-k)$, gdzie $Y$ jest zmienną losową oznaczającą liczbę porażek uzyskanych w~tym doświadczeniu.
Mamy $np<k<n$, skąd $0<n-k<nq$, a~zatem możemy zastosować tw.\ C.4 dla zmiennej losowej $Y$, zamieniając ze sobą role sukcesu i~porażki, dzięki czemu uzyskujemy żądaną nierówność.
\end{proof}

\begin{proof}[Dowód wniosku C.7]
	Jeśli $k=n$, to wniosek jest oczywiście prawdziwy, bo szanse uzyskania więcej niż $n$ sukcesów są zerowe.
Załóżmy więc, że $k<n$.
Analogicznie do poprzedniego dowodu potraktujmy prawdopodobieństwo uzyskania więcej niż $k$ sukcesów jako prawdopodobieństwo uzyskania mniej niż $n-k$ porażek.
Ponieważ $(np+n)/2<k<n$, to $0<n-k<nq/2$ i~po zamianie sukcesu z~porażką stosujemy wniosek C.5.
\end{proof}

\exercise %C.5-3
\note{W~rzeczywistości nierówność nie zachodzi dla podanego warunku.
Powinno być\/ $0<k<\frac{a}{a+1}n$, bo tylko wtedy można zastosować twierdzenie C.4.}

\noindent Niech $p=\frac{a}{a+1}$, skąd mamy, że $q=\frac{1}{a+1}$ oraz $a=\frac{p}{1-p}$.
Zachodzi
\[
	\sum_{i=0}^{k-1}\binom{n}{i}a^i = \sum_{i=0}^{k-1}\binom{n}{i}\biggl(\frac{p}{1-p}\biggr)^i = \frac{\sum_{i=0}^{k-1}\binom{n}{i}p^i(1-p)^{n-i}}{(1-p)^n} = \frac{\sum_{i=0}^{k-1}b(i;n,p)}{q^n},
\]
zatem z~tw.\ C.4 otrzymujemy
\[
	\sum_{i=0}^{k-1}\binom{n}{i}a^i < \frac{\frac{k}{a+1}}{\bigl(\frac{na}{a+1}-k\bigr)\bigl(\frac{1}{a+1}\bigr)^n}\,b(k;n,a/(a+1)) = (a+1)^n\frac{k}{na-k(a+1)}\,b(k;n,a/(a+1)).
\]

\exercise %C.5-4
Wykorzystując obserwację, że $\binom{n}{i}\ge1$ dla $i=0$, 1, \dots, $n$ oraz tw.\ C.4, mamy
\[
	\sum_{i=0}^{k-1}p^iq^{n-i} \le \sum_{i=0}^{k-1}\binom{n}{i}p^iq^{n-i} = \sum_{i=0}^{k-1}b(i;n,p) < \frac{kq}{np-k}\,b(k;n,p).
\]
Z~kolei na mocy lematu C.1 dostajemy
\[
	\frac{kq}{np-k}\,b(k;n,p) \le \frac{kq}{np-k}\biggl(\frac{np}{k}\biggr)^k\biggl(\frac{nq}{n-k}\biggr)^{n-k}.
\]

\exercise %C.5-5
\note{Aby udowodnić nierówność, wymagane jest założenie, że $r>n-\mu$, którego brak w~treści zadania (także w~oryginale).}

\noindent Niech $\nu$ będzie wartością oczekiwaną zmiennej losowej $Y=n-X$.
Wówczas
\[
        \nu = \E(Y) = \E(n-X) = n-\E(X) = n-\mu.
\]
Na mocy tw.\ C.8 mamy, że
\[
        \Pr(Y-\nu\ge r) \le \biggl(\frac{\nu e}{r}\biggr)^r,
\]
skąd dostajemy nierówność
\[
        \Pr(\mu-X\ge r) \le \biggl(\frac{(n-\mu)e}{r}\biggr)^r.
\]

W~dowodzie nierówności z~drugiej części zadania zauważmy, że $\mu=\E(X)=np$ i~na mocy nierówności udowodnionej w~pierwszej części otrzymujemy
\[
    \Pr(np-X\ge r) \le \biggl(\frac{(n-np)e}{r}\biggr)^r = \biggl(\frac{nqe}{r}\biggr)^r.
\]

\exercise %C.5-6
\note{W~treści zadania występuje błąd.
Prawa strona nierówności ze wskazówki powinna mieć postać\/ $e^{\alpha^2\!/2}$.}

\noindent\textsf{\textbf{Lemat.}} \textit{Dla dowolnych $\alpha>0$, \/$p$, \/$q\ge0$, spełniających\/ $p+q=1$, prawdziwa jest nierówność}
	\[
		pe^{\alpha q}+qe^{-\alpha p} \le e^{\alpha^2\!/2}.
	\]
\begin{proof}
	Przekształćmy nierówność do alternatywnej postaci:
	\begin{align*}
		pe^{\alpha q}+qe^{-\alpha p} &\le e^{\alpha^2\!/2}, \\
		pe^{\alpha(1-p)}+(1-p)e^{-\alpha p} &\le e^{\alpha^2\!/2}, \\
		pe^\alpha-p+1 &\le e^{\alpha^2\!/2+\alpha p}, \\
		\ln(pe^\alpha-p+1) &\le \alpha^2\!/2+\alpha p, \\
		\ln(pe^\alpha-p+1)-\alpha^2\!/2-\alpha p &\le 0.
	\end{align*}
	Ustalmy $p$ i~potraktujmy wyrażenie po lewej stronie znaku ostatniej nierówności jako funkcję $f_p$ zmiennej $\alpha$.
Zauważmy, że granicą prawostronną tej funkcji w~punkcie 0 dla dowolnego $0\le p\le1$ jest 0.
Udowodnimy, że wraz ze wzrostem $\alpha$ funkcja $f_p$ maleje, co będzie oznaczać, że przyjmuje ona wyłącznie wartości niedodatnie i~uzasadni nierówność.
Obliczmy w~tym celu pochodną $f_p$:
	\[
	    \frac{df_p}{d\alpha}(\alpha) = \frac{pe^\alpha}{pe^\alpha-p+1}-\alpha-p = \frac{pe^\alpha(1-\alpha-p)+(\alpha+p)(p-1)}{pe^\alpha-p+1}.
	\]
	Mianownik ostatniego ułamka jest dodatni.
Wystarczy wykazać, że licznik jest ujemny dla każdych $\alpha>0$, $0\le p\le1$, czyli, równoważnie,
	\[
	    (\alpha+p)(p-1) < pe^\alpha(\alpha+p-1).
	\]

	Rozważmy dwa przypadki w~zależności od znaku wyrażenia $\alpha+p-1$.
Jeśli $\alpha+p-1\ge0$, to $\alpha\ge1-p$.
Zachodzi
	\[
	    (\alpha+p)(p-1)-p(1+\alpha)(\alpha+p-1) = -\alpha(\alpha p+p^2-p+1) < 0.
	\]
	Korzystając ze wzoru (3.12) i~z~tego, że $\alpha>0$, mamy $1+\alpha<e^\alpha$, zatem
	\[
	    (\alpha+p)(p-1) < p(1+\alpha)(\alpha+p-1) < pe^\alpha(\alpha+p-1).
	\]
	W~drugim przypadku, czyli gdy $\alpha+p-1<0$, mamy $0<\alpha<1-p$ oraz
	\[
	    (\alpha+p)(p-1)-p(1+\alpha+\alpha^2)(\alpha+p-1) = -\alpha(\alpha^2p+\alpha p^2+p^2-p+1) < 0.
	\]
	Wykorzystując ponownie wzór (3.12), dostajemy $e^\alpha<1+\alpha+\alpha^2$, więc
	\[
		(\alpha+p)(p-1) < p(1+\alpha+\alpha^2)(\alpha+p-1) < pe^\alpha(\alpha+p-1).
	\]

	Otrzymaliśmy ostatecznie, że pochodna funkcji $f_p$, gdzie $0\le p\le1$, jest ujemna dla każdego $\alpha>0$.
A~zatem funkcja $f_p$ jest malejąca.
\end{proof}

Początek głównego rozumowania prowadzimy w~oparciu o~dowód twierdzenia C.8:
\[
	\Pr(X-\mu\ge r) = \Pr\bigl(e^{\alpha(X-\mu)}\ge e^{\alpha r}\bigr) \le \E\bigl(e^{\alpha(X-\mu)}\bigr)e^{-\alpha r}.
\]
Następnie, przy tych samych oznaczeniach jak w~oryginalnym dowodzie, zachodzi
\[
	\E\bigl(e^{\alpha(X-\mu)}\bigr) = \prod_{i=1}^n\E\bigl(e^{\alpha(X_i-p_i)}\bigr).
\]
Wykorzystując udowodnioną w~lemacie nierówność dla $p=p_i$ oraz $q=q_i$, otrzymujemy
\[
	\E\bigl(e^{\alpha(X_i-p_i)}\bigr) = e^{\alpha(1-p_i)}p_i+e^{\alpha(0-p_i)}q_i = p_ie^{\alpha q_i}+q_ie^{-\alpha p_i} \le e^{\alpha^2\!/2}
\]
i~dalej mamy
\[
	\E\bigl(e^{\alpha(X-\mu)}\bigr) = \prod_{i=1}^n\E\bigl(e^{\alpha(X_i-p_i)}\bigr) \le \prod_{i=1}^ne^{\alpha^2\!/2} = \exp(\alpha^2n/2).
\]
Wobec tego
\[
	\Pr(X-\mu\ge r) \le \E\bigl(e^{\alpha(X-\mu)}\bigr)e^{-\alpha r} \le \exp(\alpha^2n/2-\alpha r).
\]
Należy teraz wybrać taką wartość $\alpha$, która minimalizuje ostatnie wyrażenie.
Argumentem funkcji wykładniczej w~tym wyrażeniu jest funkcja kwadratowa zmiennej $\alpha$, w~prosty sposób można więc sprawdzić, że osiąga ona minimum dla argumentu $\alpha=r/n$.
Dostajemy ostatecznie
\[
	\Pr(X-\mu\ge r) \le \exp\bigl((r/n)^2n/2-(r/n)r\bigr) = e^{-r^2\!/{2n}}.
\]

\exercise %C.5-7
Potraktujmy wyrażenie jak funkcję $f$ zmiennej $\alpha>0$, $f(\alpha)=\exp(\mu e^\alpha-\alpha r).$ W~celu wyznaczenia jej minimum obliczmy pierwszą i~drugą pochodną:
\begin{align*}
	\frac{df}{d\alpha}(\alpha) &= (\mu e^\alpha-r)\exp(\mu e^\alpha-\alpha r), \\
	\frac{d^2\!f}{d\alpha^2}(\alpha) &= \bigl(\mu e^\alpha+(\mu e^\alpha-r)^2\bigr)\exp(\mu e^\alpha-\alpha r).
\end{align*}
Pierwsza pochodna zeruje się dla $\alpha=\ln(r/\mu)$, co wymaga założenia $r>\mu$, ale warunek ten stanowi jedno z~założeń tw.\ C.8.
Po obliczeniu wartości drugiej pochodnej w~tym punkcie, dostajemy
\[
	\frac{d^2\!f}{d\alpha^2}(\ln(r/\mu)) = r\exp(r-r\ln(r/\mu)) > 0,
\]
ponieważ funkcja wykładnicza jest dodatnia oraz $r>\mu\ge0$.
A~zatem w~punkcie $\alpha=\ln(r/\mu)$ istnieje minimum funkcji $f$.
