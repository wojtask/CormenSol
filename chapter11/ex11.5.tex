\subchapter{Haszowanie doskonałe}

\exercise %11.5-1
\note{W~treści zadania zamiast haszowania uniwersalnego powinno być haszowanie równomierne.}

\noindent Rozważmy prawdopodobieństwo $q(n,m)$, że wystąpi przynajmniej jedna kolizja.
Jest $\binom{n}{2}$ par kluczy, które mogą tworzyć kolizję z~prawdopodobieństwem $1/m$ każda.
Mamy więc
\[
	q(n,m) = \binom{n}{2}\frac{1}{m} = \frac{n(n-1)}{2m}
\]
i~teraz, dzięki skorzystaniu ze wzoru (3.11), otrzymujemy
\[
	p(n,m) = 1-q(n,m) = 1-\frac{n(n-1)}{2m} \le e^{-n(n-1)/2m}.
\]

W~drugiej części zadania rozważymy funkcję $f(x)=e^{-x(x-1)/2m}$ zmiennej rzeczywistej $x$, traktując $m$ jak stałą dodatnią.
Wyznaczając jej pierwszą i~drugą pochodną, mamy
\[
	f'(x) = e^{-x(x-1)/2m}\,\frac{1-2x}{2m}
\]
oraz
\[
	f''(x) = e^{-x(x-1)/2m}\biggl(\frac{1-2x}{2m}\biggr)^2+e^{-x(x-1)/2m}\cdot\frac{-1}{m} = e^{-x(x-1)/2m}\,\frac{(2x-1)^2-4m}{4m^2}.
\]
Czynnik $e^{-x(x-1)/2m}$ jest dodatni niezależnie od wartości $x$ i~$m$.
Funkcja $f'$ jest ujemna dla $x>1/2$.
Z~kolei dla $x>\sqrt{m}+1/2$ funkcja $f''$ jest dodatnia, bo
\[
	\frac{(2x-1)^2-4m}{4m^2} > \frac{(2\sqrt{m})^2-4m}{4m^2} = 0.
\]
Dla $x>\sqrt{m}+1/2$ funkcja $f$ jest więc malejąca i~wypukła.
Oznacza to, że prawdopodobieństwo niewystępowania kolizji $p(n,m)$ ograniczone od góry przez $f(n)$ maleje wraz ze wzrostem $n$, aby dla $n>\sqrt{m}+1/2$ gwałtownie zbiegać do $\lim_{x\to\infty}f(x)=0$.
