\subchapter{Własności drzew czerwono-czarnych}

\exercise %13.1-1
Drzewa zostały przedstawione na rys.\ \ref{fig:13.1-1}.
\begin{figure}[!ht]
	\centering \input{fig13.1-1}
	\caption{Drzewa czerwono-czarne o~wysokości 3 zawierające zbiór kluczy $\{$1,\! 2,\! \dots,\! 15$\}$ z~dodanymi liśćmi \const{nil}.
	Czarna wysokość tych drzew wynosi, odpowiednio, {\sffamily\bfseries(a)} 2, {\sffamily\bfseries(b)} 3 oraz {\sffamily\bfseries(c)} 4.} \label{fig:13.1-1}
\end{figure}

\exercise %13.1-2
Rys.\ \ref{fig:13.1-2} przedstawia drzewo po dodaniu nowego węzła o~nieustalonym kolorze.
Pokolorowanie go na czerwono spowodowałoby naruszenie własności 4 drzewa czerwono-czarnego, a na czarno własności 5 -- na prostej ścieżce od korzenia drzewa do liścia \const{nil}, będącego synem nowego węzła, znalazłoby się 5 czarnych węzłów, a~na prostej ścieżce od korzenia do dowolnego innego liścia \const{nil} byłyby 4 czarne węzły.
A~zatem, niezależnie od wyboru koloru dla nowego węzła, wynikowe drzewo nie będzie drzewem czerwono-czarnym.
\begin{figure}[!ht]
	\centering \input{fig13.1-2}
	\caption{Drzewo z~rys.\ 13.1 z~Podręcznika po dodaniu węzła o~kluczu 36 procedurą \proc{Tree-Insert}.} \label{fig:13.1-2}
\end{figure}

\exercise %13.1-3
Po zmianie koloru korzenia na czarny w~uproszczonym drzewie czerwono-czarnym własności 1--4 drzewa czerwono-czarnego oczywiście będą spełnione.
Liczba czarnych węzłów na każdej prostej ścieżce od korzenia do liścia zwiększy się o~1, a~liczba czarnych węzłów na prostych ścieżkach od dowolnego innego węzła do ich potomnych liści nie zmieni się.
To oznacza, że także własność 5 nie będzie naruszona i~otrzymane drzewo będzie drzewem czerwono-czarnym.

\exercise %13.1-4
Niech $x$ będzie czarnym węzłem w~drzewie czerwono-czarnym.
Jeśli $x$ nie ma czerwonego syna, to w~wyniku pochłaniania czerwonych węzłów jego stopień nie zmieni się i~będzie nadal wynosił 0, gdy $x$ jest liściem \const{nil}, albo 2, gdy $x$ jest węzłem wewnętrznym.
Jeśli $x$ ma dokładnie jednego czerwonego syna $y$, to pochłaniając go, przyjmuje czarnych synów $y$, zwiększając swój stopień do 3.
Gdy obaj synowie $y_1$, $y_2$ węzła $x$ są czerwoni, to po ich pochłonięciu $x$ będzie ojcem 4 czarnych węzłów, które początkowo były synami węzłów $y_1$ i~$y_2$.

Po pochłonięciu wszystkich czerwonych węzłów dowolna prosta ścieżka od korzenia do liścia będzie składać się z~tej samej liczby węzłów, skąd wynika, że głębokość każdego liścia będzie równa czarnej wysokości początkowego drzewa czerwono-czarnego.

\exercise %13.1-5
Skorzystamy z~faktu, że każda prosta ścieżka z~ustalonego węzła $x$ do jego potomnego czarnego liścia w~danym drzewie czerwono-czarnym składa się z~tej samej liczby czarnych węzłów.
Na możliwie najkrótszej takiej ścieżce są same czarne węzły (być może z~wyjątkiem $x$) i~jej długością jest czarna wysokość węzła $x$.
Najdłuższa możliwa ścieżka powstaje z~najkrótszej poprzez umieszczenie czerwonego węzła pomiędzy każdą parą sąsiednich czarnych węzłów, w~wyniku czego długość ścieżki może zwiększyć się maksymalnie dwukrotnie.

\exercise %13.1-6
Drzewo czerwono-czarne o~czarnej wysokości $k$ ma najmniejszą możliwą liczbę węzłów wewnętrznych, jeśli każda prosta ścieżka od korzenia do liścia jest możliwie najkrótsza.
Podobnie, największa liczba węzłów wewnętrznych w~tym drzewie jest osiągana, gdy każda taka ścieżka jest możliwie najdłuższa.
Na podstawie poprzedniego zadania mamy, że długość takiej ścieżki, a~co za tym idzie także wysokość drzewa, wynosi co najmniej $k$ i~co najwyżej $2k$.
Drzewo składa się zatem z~co najmniej $2^k-1$ i~co najwyżej $2^{2k}-1$ węzłów wewnętrznych.

\exercise %13.1-7
Rozumując podobnie jak w~\refExercise{13.1-5}, możemy wywnioskować, że w~drzewie czerwono-czarnym na prostej ścieżce od korzenia do ojca liścia (najniżej położonego węzła wewnętrznego na tej ścieżce) węzłów czerwonych może być co najwyżej tyle samo co czarnych.
Jeśli każda taka ścieżka zawiera maksymalną liczbę czerwonych węzłów, to drzewo jest pełnym drzewem binarnym o~wysokości parzystej, w~którym na parzystych poziomach są węzły czarne, a~na nieparzystych -- czerwone.
Przykładem takiego drzewa jest to zobrazowane na rys.\ \ref{fig:13.1-1}(a).
W~takich drzewach czerwonych węzłów wewnętrznych jest 2 razy więcej niż czarnych węzłów wewnętrznych.

Z~drugiej strony zauważmy, że pełne drzewo wyszukiwań binarnych, w~którym wszystkie węzły są czarne, jest poprawnym drzewem czerwono-czarnym (np.\ to z~rys.\ \ref{fig:13.1-1}(c)).
Minimalny stosunek czerwonych węzłów wewnętrznych do czarnych węzłów wewnętrznych wynosi więc 0.
