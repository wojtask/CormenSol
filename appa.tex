\chapter{Sumy}

\subchapter{Wzory i~własności dotyczące sum}

\exercise %A.1-1
\[
	\sum_{k=1}^n(2k-1) = 2\sum_{k=1}^nk-\sum_{k=1}^n1 = \frac{2n(n+1)}{2}-n = n^2
\]

\exercise %A.1-2
Korzystając z~oszacowania na $H_n$ (wzór~(A.7)), mamy
\begin{align*}
	\sum_{k=1}^n\frac{1}{2k-1} &= H_{2n-1}-\sum_{k=1}^{n-1}\frac{1}{2k} \\
	&= H_{2n-1}-\frac{H_{n-1}}{2} \\
	&= \ln(2n-1)+O(1)-\frac{\ln(n-1)+O(1)}{2} \\
	&= \ln(2n-2)+\ln\frac{2n-1}{2n-2}-\ln\sqrt{n-1}+O(1) \\
	&= \ln\frac{2n-2}{\sqrt{n-1}}+O(1) \\[1mm]
	&= \ln\bigl(2\sqrt{n-1}\bigr)+O(1) \\
	&= \ln2+\ln\sqrt{n}+\ln\frac{\sqrt{n-1}}{\sqrt{n}}+\,O(1) \\
	&= \ln\sqrt{n}+O(1).
\end{align*}
Wyrażenia $\ln\frac{2n-1}{2n-2}$ i~$\ln\frac{\sqrt{n-1}}{\sqrt{n}}$ zostały potraktowane jak funkcje klasy $O(1)$.

\exercise %A.1-3
Wykorzystując wzór~(A.8), dostajemy
\[
	\sum_{k=0}^\infty k^2x^k = x\cdot\frac{d}{dx}\sum_{k=0}^\infty kx^k = \frac{x(x+1)}{(1-x)^3}.
\]

\exercise %A.1-4
Korzystając ze wzorów~(A.6) oraz~(A.8), mamy
\[
	\sum_{k=0}^\infty\frac{k-1}{2^k} = \sum_{k=0}^\infty\frac{k}{2^k}-\sum_{k=0}^\infty\frac{1}{2^k} = \sum_{k=0}^\infty k\biggl(\frac{1}{2}\biggr)^k-\sum_{k=0}^\infty\biggl(\frac{1}{2}\biggr)^k = \frac{\frac{1}{2}}{\bigl(1-\frac{1}{2}\bigr)^2}-\frac{1}{1-\frac{1}{2}} = 0.
\]

\exercise %A.1-5
Załóżmy, że $|x^2|<1$, czyli $-1<x<1$. Wówczas na podstawie wzorów~(A.6) i~(A.8) obliczamy:
\[
	\sum_{k=1}^\infty(2k+1)x^{2k} = 2\sum_{k=0}^\infty k(x^2)^k+\sum_{k=0}^\infty(x^2)^k-1 = \frac{2x^2}{(1-x^2)^2}+\frac{1}{1-x^2}-1 = \frac{x^2(3-x^2)}{(1-x^2)^2}.
\]
W~przypadku, gdy $|x^2|\ge1$, badana suma jest rozbieżna do $\infty$.

\exercise %A.1-6
Zgodnie z~definicją notacji $O$, dla dowolnej funkcji $F(n)$ zachodzi $F(n)=O\bigl(\sum_{k=1}^nf_k(n)\bigr)$ wtedy i~tylko wtedy, gdy istnieją stałe $n_0$, $c>0$ takie, że dla każdego całkowitego $n\ge n_0$ prawdą jest
\[
	0 \le F(n) \le c\sum_{k=1}^n f_k(n).
\]

Ustalmy dodatnie stałe $n_0$ i~$c$. Niech $F_1(n)$, $F_2(n)$,~\dots,~$F_n(n)$ będą funkcjami, które dla każdego całkowitego $n\ge n_0$ spełniają układ nierówności
\[
	\begin{cases}
		0 \le F_1(n) \le cf_1(n), \\
		0 \le F_2(n) \le cf_1(n)+cf_2(n), \\
		\phantom{0 \le F_2} \vdots \\
		0 \le F_n(n) \le \sum_{k=1}^ncf_k(n). \\
	\end{cases}
\]
Wprost z~definicji notacji $O$ mamy:
\begin{align*}
	F_1(n) &= O(f_1(n)), \\
	F_2(n)-F_1(n) &= O(f_2(n)), \\
	& \,\,\,\vdots \\
	F_n(n)-F_{n-1}(n) &= O(f_n(n)).
\end{align*}
Dodając powyższe równania stronami, otrzymujemy
\[
	F_1(n)+(F_2(n)-F_1(n))+\dots+(F_n(n)-F_{n-1}(n)) = \sum_{k=1}^nO(f_k(n)).
\]
Wartość po lewej stronie jest równa $F_n(n)$. Ale z~ostatniej nierówności układu wynika, że $F_n(n)=O\bigl(\sum_{k=1}^nf_k(n)\bigr)$, skąd dostajemy tożsamość
\[
	\sum_{k=1}^nO(f_k(n)) = O\biggl(\sum_{k=1}^nf_k(n)\biggr).
\]

\exercise %A.1-7
\[
	\prod_{k=1}^n2\cdot4^k = 2^n\cdot4^{1+2+\dots+n} = 2^n\cdot4^{\frac{n(n+1)}{2}} = 2^{n(n+2)}
\]

\exercise %A.1-8
\begin{align*}
	\prod_{k=2}^n\biggl(1-\frac{1}{k^2}\biggr) &= \prod_{k=2}^n\frac{k^2-1}{k^2} = \frac{\prod_{k=2}^n(k^2-1)}{\prod_{k=2}^nk^2} = \frac{\prod_{k=2}^n(k-1)\cdot\prod_{k=2}^n(k+1)}{\bigl(\prod_{k=1}^nk\bigr)^2} \\[2mm]
	&= \frac{\prod_{k=1}^{n-1}k\cdot\prod_{k=3}^{n+1}k}{(n!)^2} = \frac{(n-1)!\cdot\frac{(n+1)!}{2}}{(n!)^2} = \frac{n+1}{2n}
\end{align*}

\subchapter{Szacowanie sum}

\exercise %A.2-1
Wykorzystując własności szeregu teleskopowego, dostajemy
\[
	\sum_{k=1}^n\frac{1}{k^2} \le 1+\sum_{k=2}^n\frac{1}{k(k-1)} = 1+\sum_{k=2}^n\biggl(\frac{1}{k-1}-\frac{1}{k}\biggr) = 1+1-\frac{1}{n} < 2,
\]
a~zatem badana suma jest ograniczona z~góry przez stałą. Można pokazać, że wraz ze wzrostem $n$ wartość tej sumy zbliża się do $\pi^2\!/6$.

\exercise %A.2-2
Zauważmy, że gdy $n$ osiąga wartość będącą potęgą~2, to zwiększa się o~1 liczba sumowanych składników. Funkcja $F(n)=\sum_{k=0}^{\lfloor\lg n\rfloor}\bigl\lceil n/2^k\bigr\rceil$, zdefiniowana dla dodatnich liczb całkowitych, jest niemalejąca, więc jeśli $m$ jest liczbą całkowitą dodatnią, to $F(n)<F(2^m)$ dla wszystkich $n<2^m$. Oszacowaniem górnym tej funkcji jest zatem oszacowanie górne jej wartości przyjmowanych dla potęg~2. Dla $n=2^m$ zachodzi
\[
	F(n) = F(2^m) = \sum_{k=0}^m\biggl\lceil\frac{2^m}{2^k}\biggr\rceil = 2^m+2^{m-1}+\dots+2^0 = 2^{m+1}-1 = 2n-1,
\]
z~czego wynika, że $F(n)=O(n)$ i~asymptotycznym górnym ograniczeniem sumy jest $O(n)$.

\exercise %A.2-3
Postępując podobnie jak podczas badania oszacowania górnego \onedash{$n$}{tej} liczby harmonicznej, dzielimy zakres indeksów od 1 od $n$ na $\lfloor\lg n\rfloor$ części i~ograniczamy sumę każdej części przez $1/2$:
\[
    \sum_{k=1}^n\frac{1}{k} \ge \sum_{i=0}^{\lfloor\lg n\rfloor-1}\sum_{j=0}^{2^i-1}\frac{1}{2^i+j} \ge \sum_{i=0}^{\lfloor\lg n\rfloor-1}\sum_{j=0}^{2^i-1}\frac{1}{2^{i+1}} = \sum_{i=0}^{\lfloor\lg n\rfloor-1}\frac{1}{2} = \frac{\lfloor\lg n\rfloor}{2} = \Omega(\lg n).
\]

\exercise %A.2-4
Funkcja $f(k)=k^3$, gdzie $k$ to dodatnia liczba całkowita, jest monotonicznie rosnąca, zatem szacujemy sumę, korzystając z~nierówności~(A.11):
\[
	\int_0^nx^3\,dx \le \sum_{k=1}^nk^3 \le \int_1^{n+1}x^3\,dx.
\]
Znajdujemy oszacowania obu całek:
\begin{gather*}
	\int_0^nx^3\,dx = \frac{n^4}{4} = \Theta(n^4), \\[2mm]
	\int_1^{n+1}x^3\,dx = \frac{(n+1)^4-1}{4} = \Theta(n^4)
\end{gather*}
i~otrzymujemy
\[
	\sum_{k=1}^nk^3 = \Theta(n^4).
\]

\exercise %A.2-5
Zastosowanie nierówności~(A.12) do sumy $\sum_{k=1}^n1/k$ doprowadza do całki niewłaściwej:
\[
	\sum_{k=1}^n\frac{1}{k} \le \int_0^n\frac{dx}{x} = \lim_{a\to0^+}\int_a^n\frac{dx}{x} = \infty.
\]
W~rezultacie nie uzyskujemy żadnej informacji o~oszacowaniu górnym badanej sumy. Dzięki zapisaniu jej w~postaci $1+\sum_{k=2}^n1/k$, można zastosować wzór~(A.12) do drugiego składnika i~otrzymać oszacowanie górne $\ln n+1$ na sumę wyjściową.

\problems

\problem{Szacowanie sum} %A-1
W~celu wyznaczenia asymptotycznych oszacowań dokładnych dla każdej z~sum, znajdziemy ich oszacowania górne i~dolne poprzez zastąpienie odpowiednimi wartościami każdego składnika danej sumy. Ponieważ parzystość $n$ nie ma znaczenia dla postaci oszacowań tych sum, to dla uproszczenia rachunków będziemy przyjmować, że $n$ jest liczbą parzystą.

\subproblem %A-1(a)
Oszacowanie górne:
\[
    \sum_{k=1}^nk^r \le \sum_{k=1}^nn^r = n\cdot n^r = O(n^{r+1}).
\]
Oszacowanie dolne:
\[
    \sum_{k=1}^nk^r \ge \sum_{k=n/2+1}^nk^r \ge \sum_{k=n/2+1}^n(n/2)^r = (n/2)\cdot(n/2)^r = \Omega(n^{r+1}).
\]
Na podstawie otrzymanych wyników stwierdzamy, że oszacowaniem dokładnym sumy jest
\[
    \sum_{k=1}^nk^r = \Theta(n^{r+1}).
\]

\subproblem %A-1(b)
Oszacowanie górne:
\[
    \sum_{k=1}^n\lg^sk \le \sum_{k=1}^n\lg^sn = n\cdot\lg^sn = O(n\lg^sn).
\]
Oszacowanie dolne:
\[
    \sum_{k=1}^n\lg^sk \ge \sum_{k=n/2+1}^n\lg^sk \ge \sum_{k=n/2+1}^n\lg^s(n/2) = (n/2)\cdot\lg^s(n/2) = \Omega(n\lg^sn).
\]
Oszacowanie dokładne:
\[
    \sum_{k=1}^n\lg^sk = \Theta(n\lg^sn).
\]

\subproblem %A-1(c)
Oszacowanie górne:
\[
    \sum_{k=1}^nk^r\lg^sk \le \sum_{k=1}^nn^r\lg^sn = n\cdot n^r\lg^sn = O(n^{r+1}\lg^sn).
\]
Oszacowanie dolne:
\[
    \sum_{k=1}^nk^r\lg^sk \ge \!\!\sum_{k=n/2+1}^n\!\!k^r\lg^sk \ge \!\!\sum_{k=n/2+1}^n\!\!(n/2)^r\lg^s(n/2) = (n/2)\cdot(n/2)^r\lg^s(n/2) = \Omega(n^{r+1}\lg^sn).
\]
Oszacowanie dokładne:
\[
    \sum_{k=1}^nk^r\lg^sk = \Theta(n^{r+1}\lg^sn).
\]
Przyjmując w~powyższym oszacowaniu, odpowiednio, $s=0$ i~$r=0$, otrzymujemy sumy i~ich oszacowania z~punktów (a) i~(b).

\endinput
