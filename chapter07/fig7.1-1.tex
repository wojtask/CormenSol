\begin{tikzpicture}[
	light cell/.style = {row 1 column #1/.style={nodes={fill=black!20}}},
	med cell/.style = {row 1 column #1/.style={nodes={fill=black!40}}},
	index node/.append style = {node distance=1mm and 1mm},
	partition line/.style = {line width=2pt, line cap=rect},
	outer/.append style = {node distance=4mm and 14mm}
]

\node[outer] (pic a) {
\begin{tikzpicture}
	\matrix[array] (arr) {13 & 19 & 9 & 5 & 12 & 8 & 7 & 4 & 21 & 2 & 6 & 11 \\};
	\draw[partition line] (arr-1-1.north west) -- (arr-1-1.south west);
	\draw[partition line] (arr-1-11.north east) -- (arr-1-11.south east);
	\node[index node, above left=of arr-1-1] {$i$};
	\node[index node, above=of arr-1-1] {$p,j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, below=of pic a] (pic b) {
\begin{tikzpicture}
	\matrix[
		array,
		med cell/.list = {1}
	] (arr) {13 & 19 & 9 & 5 & 12 & 8 & 7 & 4 & 21 & 2 & 6 & 11 \\};
	\draw[partition line] (arr-1-1.north west) -- (arr-1-1.south west);
	\draw[partition line] (arr-1-2.north west) -- (arr-1-2.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above left=of arr-1-1] {$i$};
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-2] {$j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, below=of pic b] (pic c) {
\begin{tikzpicture}
	\matrix[
		array,
		med cell/.list = {1,2}
	] (arr) {13 & 19 & 9 & 5 & 12 & 8 & 7 & 4 & 21 & 2 & 6 & 11 \\};
	\draw[partition line] (arr-1-1.north west) -- (arr-1-1.south west);
	\draw[partition line] (arr-1-3.north west) -- (arr-1-3.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above left=of arr-1-1] {$i$};
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-3] {$j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, below=of pic c.south east, anchor=north east] (pic d) {
\begin{tikzpicture}
	\matrix[
		array,
		light cell/.list = {1},
		med cell/.list = {2,3}
	] (arr) {9 & 19 & 13 & 5 & 12 & 8 & 7 & 4 & 21 & 2 & 6 & 11 \\};
	\draw[partition line] (arr-1-2.north west) -- (arr-1-2.south west);
	\draw[partition line] (arr-1-4.north west) -- (arr-1-4.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above=of arr-1-1] {$p,i$};
	\node[index node, above=of arr-1-4] {$j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, below=of pic d] (pic e) {
\begin{tikzpicture}
	\matrix[
		array,
		light cell/.list = {1,2},
		med cell/.list = {3,4}
	] (arr) {9 & 5 & 13 & 19 & 12 & 8 & 7 & 4 & 21 & 2 & 6 & 11 \\};
	\draw[partition line] (arr-1-3.north west) -- (arr-1-3.south west);
	\draw[partition line] (arr-1-5.north west) -- (arr-1-5.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-2] {$i$};
	\node[index node, above=of arr-1-5] {$j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, below=of pic e] (pic f) {
\begin{tikzpicture}
	\matrix[
		array,
		light cell/.list = {1,2},
		med cell/.list = {3,4,5}
	] (arr) {9 & 5 & 13 & 19 & 12 & 8 & 7 & 4 & 21 & 2 & 6 & 11 \\};
	\draw[partition line] (arr-1-3.north west) -- (arr-1-3.south west);
	\draw[partition line] (arr-1-6.north west) -- (arr-1-6.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-2] {$i$};
	\node[index node, above=of arr-1-6] {$j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, below=of pic f] (pic g) {
\begin{tikzpicture}
	\matrix[
		array,
		light cell/.list = {1,2,3},
		med cell/.list = {4,5,6}
	] (arr) {9 & 5 & 8 & 19 & 12 & 13 & 7 & 4 & 21 & 2 & 6 & 11 \\};
	\draw[partition line] (arr-1-4.north west) -- (arr-1-4.south west);
	\draw[partition line] (arr-1-7.north west) -- (arr-1-7.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-3] {$i$};
	\node[index node, above=of arr-1-7] {$j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, right=of pic a.east] (pic h) {
\begin{tikzpicture}
	\matrix[
		array,
		light cell/.list = {1,2,3,4},
		med cell/.list = {5,6,7}
	] (arr) {9 & 5 & 8 & 7 & 12 & 13 & 19 & 4 & 21 & 2 & 6 & 11 \\};
	\draw[partition line] (arr-1-5.north west) -- (arr-1-5.south west);
	\draw[partition line] (arr-1-8.north west) -- (arr-1-8.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above left=of arr-1-1] {};
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-4] {$i$};
	\node[index node, above=of arr-1-8] {$j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, below=of pic h.south east, anchor=north east] (pic i) {
\begin{tikzpicture}
	\matrix[
		array,
		light cell/.list = {1,2,3,4,5},
		med cell/.list = {6,7,8}
	] (arr) {9 & 5 & 8 & 7 & 4 & 13 & 19 & 12 & 21 & 2 & 6 & 11 \\};
	\draw[partition line] (arr-1-6.north west) -- (arr-1-6.south west);
	\draw[partition line] (arr-1-9.north west) -- (arr-1-9.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-5] {$i$};
	\node[index node, above=of arr-1-9] {$j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, below=of pic i] (pic j) {
\begin{tikzpicture}
	\matrix[
		array,
		light cell/.list = {1,2,3,4,5},
		med cell/.list = {6,7,8,9}
	] (arr) {9 & 5 & 8 & 7 & 4 & 13 & 19 & 12 & 21 & 2 & 6 & 11 \\};
	\draw[partition line] (arr-1-6.north west) -- (arr-1-6.south west);
	\draw[partition line] (arr-1-10.north west) -- (arr-1-10.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-5] {$i$};
	\node[index node, above=of arr-1-10] {$j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, below=of pic j] (pic k) {
\begin{tikzpicture}
	\matrix[
		array,
		light cell/.list = {1,2,3,4,5,6},
		med cell/.list = {7,8,9,10}
	] (arr) {9 & 5 & 8 & 7 & 4 & 2 & 19 & 12 & 21 & 13 & 6 & 11 \\};
	\draw[partition line] (arr-1-7.north west) -- (arr-1-7.south west);
	\draw[partition line] (arr-1-11.north west) -- (arr-1-11.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-6] {$i$};
	\node[index node, above=of arr-1-11] {$j$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[outer, below=of pic k] (pic l) {
\begin{tikzpicture}
	\matrix[
		array,
		light cell/.list = {1,2,3,4,5,6,7},
		med cell/.list = {8,9,10,11}
	] (arr) {9 & 5 & 8 & 7 & 4 & 2 & 6 & 12 & 21 & 13 & 19 & 11 \\};
	\draw[partition line] (arr-1-8.north west) -- (arr-1-8.south west);
	\draw[partition line] (arr-1-12.north west) -- (arr-1-12.south west);
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-7] {$i$};
	\node[index node, above=of arr-1-12] {$r,j$};
\end{tikzpicture}
};

\node[outer, below=of pic l] (pic m) {
\begin{tikzpicture}
	\matrix[
		array,
		light cell/.list = {1,2,3,4,5,6,7},
		med cell/.list = {9,10,11,12}
	] (arr) {9 & 5 & 8 & 7 & 4 & 2 & 6 & 11 & 21 & 13 & 19 & 12 \\};
	\draw[partition line] (arr-1-8.north west) -- (arr-1-8.south west);
	\draw[partition line] (arr-1-9.north west) -- (arr-1-9.south west);
	\draw[partition line] (arr-1-12.north east) -- (arr-1-12.south east);
	\node[index node, above=of arr-1-1] {$p$};
	\node[index node, above=of arr-1-7] {$i$};
	\node[index node, above=of arr-1-12] {$r$};
\end{tikzpicture}
};

\node[subpicture label, left=1mm of pic a.south west, anchor=south] (label a) {(a)};
\foreach \x in {b,c,d,e,f,g} {
	\node[subpicture label, anchor=south] at (label a |- pic \x.south west) {(\x)};
}

\node[subpicture label, left=1mm of pic h.south west, anchor=south] (label h) {(h)};
\foreach \x in {i,j,k,l,m} {
	\node[subpicture label, anchor=south] at (label h |- pic \x.south west) {(\x)};
}

\end{tikzpicture}
