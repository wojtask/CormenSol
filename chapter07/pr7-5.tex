\problem{Podział względem mediany trzech wartości} %7-5

\subproblem %7-5(a)
W~metodzie mediany trzech wartości element $A'[i]$ stanowił element rozdzielający, jeżeli był on medianą wybranego zbioru trzech wartości, w~którym znalazły się też $A'[j]$, gdzie $1\le j<i$, oraz $A'[k]$, gdzie $i<k\le n$.
Istnieje zatem $i-1$ możliwości wyboru indeksu $j$ oraz $n-i$ możliwości wyboru indeksu $k$.
Stąd
\[
	p_i = \frac{(i-1)(n-i)}{\binom{n}{3}}.
\]

\subproblem %7-5(b)
W~zwykłej implementacji szanse wyboru mediany tablicy $A[1\twodots n]$ na element rozdzielający są równe $1/n$ (z~części (a) problemu \refProblem{7-2}), natomiast w~metodzie mediany trzech wartości wynoszą one $p_{\lfloor(n+1)/2\rfloor}$.
Jeśli $n$ jest parzyste, to
\[
	p_{\lfloor(n+1)/2\rfloor} = p_{n/2} = \frac{\bigl(\frac{n}{2}-1\bigr)\bigl(n-\frac{n}{2}\bigr)}{\binom{n}{3}} = \frac{3}{2(n-1)}.
\]
Stosunek prawdopodobieństw z~obu metod dąży do
\[
    \lim_{n\to\infty}\frac{p_{\lfloor(n+1)/2\rfloor}}{1/n} = \lim_{n\to\infty}\frac{3n}{2(n-2)} = \frac{3}{2}.
\]
Dla $n$ nieparzystego mamy
\[
	p_{\lfloor(n+1)/2\rfloor} = p_{(n+1)/2} = \frac{\bigl(\frac{n+1}{2}-1\bigr)\bigl(n-\frac{n+1}{2}\bigr)}{\binom{n}{3}} = \frac{3(n-1)}{2n(n-2)},
\]
więc granica stosunku wynosi
\[
    \lim_{n\to\infty}\frac{p_{\lfloor(n+1)/2\rfloor}}{1/n} = \lim_{n\to\infty}\frac{3(n-1)}{2(n-2)} = \frac{3}{2}.
\]
A~zatem niezależnie od parzystości $n$ szanse na to, że mediana tablicy $A[1\twodots n]$ zostanie wybrana na element rozdzielający, są większe o~50\% w~metodzie mediany trzech wartości dla dostatecznie dużych $n$.

\subproblem %7-5(c)
Zgodnie z~\refExercise{7.2-6} dla $\alpha=1/3$, w~tradycyjnym podejściu szanse uzyskania dobrego podziału wynoszą w~przybliżeniu $1-2\alpha=1/3$.
W~podejściu z~medianą trzech wartości, zamiast badać sumę $\sum_{i=n/3}^{2n/3}p_i$ i~przybliżać ją całką, skorzystamy z~wyniku otrzymanego w~\refExercise{7.4-6}.
Według niego dobry podział uzyskamy z~prawdopodobieństwem około $1-2\alpha^2(3-2\alpha)=13/27$.
A~zatem, dzięki zastosowaniu nowej strategii wyboru elementu rozdzielającego, szanse na utworzenie dobrego podziału wzrastają o~czynnik $(13/27)/(1/3)=13/9$.

\subproblem %7-5(d)
Przypadek optymistyczny algorytmu quicksort jest identyczny niezależnie od zastosowanego podejścia podziału tablicy.
Użycie metody mediany trzech wartości zwiększa jedynie prawdopodobieństwo uzyskania podziału zrównoważonego, a~co za tym idzie szanse na zajście przypadku optymistycznego.
Wpływa to więc co najwyżej na stały współczynnik w~dolnym oszacowaniu na czas działania algorytmu.
