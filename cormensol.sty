\ProvidesPackage{cormensol}

\RequirePackage{fancyhdr}
\RequirePackage{calc}

% potrzebne do odpowiedniego traktowania rysunków
\ifpdf
	\DeclareGraphicsRule{*}{mps}{*}{}
\fi

% zapobiega wcinaniu pierwszej linii pierwszego paragrafu
\let\@afterindenttrue\@afterindentfalse
\@afterindentfalse

% głębokość numerowania wewnątrz spisu treści
\setcounter{tocdepth}{1}

% głębokość numerowania sekcji
\setcounter{secnumdepth}{3}

% zmiana wyglądu nagłówka części
\renewcommand{\@part}[2][default]{%
	\ifnum \c@secnumdepth >-2\relax
		\refstepcounter{part}%
		\addcontentsline{toc}{part}{\thepart\hspace{1em}#1}%
	\else
		\addcontentsline{toc}{part}{#1}%
	\fi
	\markboth{}{}%
	{%
		\interlinepenalty \@M
		\normalfont
		\ifnum \c@secnumdepth >-2\relax
			\noindent\hskip0pt\leaders\hrule height1pt \hskip10pt plus1filll \hspace{15pt}\huge\bfseries\sffamily \partname\nobreakspace\thepart
			\par
			\vskip 40\p@
		\fi
		\raggedleft\Huge \bfseries\sffamily #2\par
		\vskip 40\p@
		\rule{\textwidth}{1pt}
	}%
	\@endpart%
}

% zmiana wyglądu nagłówka rozdziału
\renewcommand{\@makechapterhead}[1]{%
	{%
		\parindent \z@ \raggedright \normalfont
		\ifnum \c@secnumdepth >\m@ne
			\if@mainmatter
				\huge\sffamily \@chapapp\space \bfseries\thechapter \hspace{15pt}\null\nobreak\leaders\hrule height1pt \hskip10pt plus1filll\ 
				\par\nobreak
				\vskip 20\p@
			\fi
		\fi
		\interlinepenalty\@M
		\Huge \bfseries\sffamily #1\par
		\vspace{5pt}
		\if@mainmatter
			\rule{\textwidth}{1pt}
			\nobreak
			\vskip 20\p@
		\else
			\nobreak
			\vskip 40\p@
		\fi
	}%
}

% definicja polecenia tworzenia podrozdziału
\newcommand\subchapter{%
\@startsection
	{section}
	{1}
	{0mm}
	{2.5\baselineskip}
	{0.5\baselineskip}
	{\Large\sffamily}
}

% definicja polecenia tworzenia (rozwiązania) zadania
\newcommand\ex@rcise{%
\@startsection
	{subsection}
	{2}
	{0mm}
	{-1.5\baselineskip}
	{0.5\baselineskip}
	{\sffamily\bfseries}
}
\newcommand{\exercise}{\ex@rcise{}}

% definicja polecenia tworzenia (rozwiązania) punktu zadania
\newcommand\subex@rcise{%
\@startsection
	{subsubsection}
	{3}
	{0mm}
	{\baselineskip}
	{0mm}
	{\sffamily\bfseries}
}
\newcommand{\subexercise}{\subex@rcise{}}

% odpowiedni wygląd liczników
\def\thechapter{\arabic{chapter}}
\def\thesection{{\bfseries\thechapter.\arabic{section}.}}
\def\thesubsection{\thechapter.\arabic{section}-\arabic{subsection}.}
\def\thesubsubsection{(\alph{subsubsection})}

% kod odpowiedzialny za uczynienie numerów rysunków i tabel globalnych
\def\@removefromreset#1#2{{%
	\expandafter\let\csname c@#1\endcsname\@removefromreset
	\def\@elt##1{
		\expandafter
		\ifx
			\csname c@##1\endcsname\@removefromreset
		\else
			\noexpand\@elt{##1}
		\fi
	}
	\expandafter\xdef\csname cl@#2\endcsname{\csname cl@#2\endcsname}}
}
\@removefromreset{figure}{chapter}
\@removefromreset{table}{chapter}

% odpowiednie wyświetlanie liczników rysunków i tabel
\def\thefigure{\arabic{figure}}
\def\thetable{\arabic{table}}

% odpowiedni wygląd nagłówków stron
\pagestyle{fancyplain}
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection{} #1}{}}
\lhead[\fancyplain{}{\small\sffamily\bfseries\thepage}]{\fancyplain{}{\small\sffamily\bfseries\rightmark}}
\rhead[\fancyplain{}{\small\sffamily\bfseries\leftmark}]{\fancyplain{}{\small\sffamily\bfseries\thepage}}
\cfoot[]{}
\addtolength{\headheight}{1.6pt}

% definicja polecenia rozpoczynającego sekcję problemów
\newcommand\problems{%
	\vspace*{1.3\baselineskip}
	\section*{{\mdseries Problemy}}
	\addcontentsline{toc}{section}{Problemy}
	\setcounter{subsection}{0}
	\renewcommand{\thesubsection}{\thechapter-\arabic{subsection}.}
	\lhead[\fancyplain{}{\small\sffamily\bfseries\thepage}]{\fancyplain{}{\small\sffamily\bfseries Problemy}}
}

% definicja poleceń wstawiających problem i punkt problemu
\newcommand{\problem}[1]{\ex@rcise{#1}}
\newcommand{\subproblem}{\subexercise}

% definicje stylów twierdzenia i lematu
\newtheoremstyle{csthm}{\topsep}{\topsep}{\itshape}{}{\sffamily\bfseries}{.}{.5em}{}
\theoremstyle{csthm}
\newtheorem{twierdzenie}{Twierdzenie}
\newtheorem{lemat}[twierdzenie]{Lemat}

% niełamliwy dywiz
\newcommand{\twoparts}[2]{{#1}\nobreakdash-{#2}}

% odnośnik do zadania
\newcommand{\zad}[1]{zad.~\hbox{#1}}

% informacja poboczna w tekście rozwiązania
\newcommand{\note}[1]{\noindent\emph{#1}\bigskip\par}

% definicja nowych operatorów matematycznych
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\I}{I}
