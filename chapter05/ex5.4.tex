\subchapter{Analiza probabilistyczna i~dalsze zastosowania zmiennych losowych wskaźnikowych}

\exercise %5.4-1
Podobnie jak w~analizie paradoksu dnia urodzin oznaczymy przez $n$ liczbę dni w~roku i~ponumerujemy osoby znajdujące się w~pokoju liczbami całkowitymi 1, 2, \dots, $k$.
Dla $i=1$, 2, \dots, $k$ niech $A_i$ będzie zdarzeniem polegającym na tym, że osoba $i$ ma urodziny kiedy indziej niż ja.
Wówczas
\[
	B_k = \bigcap_{i=1}^kA_i
\]
jest zdarzeniem, że żadna z~$k$ osób nie ma urodzin wtedy co ja.
Dla każdego $i=1$, 2, \dots, $k$ zachodzi $\Pr(A_i)=1-1/n$.
Przy założeniu, że zdarzenia $A_1$, $A_2$, \dots, $A_k$ są wzajemnie niezależne, mamy
\[
	\Pr(B_k) = \Pr\biggl(\bigcap_{i=1}^kA_i\biggr) = \prod_{i=1}^k\Pr(A_i) = \prod_{i=1}^k\biggl(1-\frac{1}{n}\biggr) = \biggl(1-\frac{1}{n}\biggr)^k.
\]
Badamy dla jakich $k$ prawdopodobieństwo zdarzenia komplementarnego do $B_k$ wynosi co najmniej $1/2$, czyli równoważnie
\[
	\biggl(1-\frac{1}{n}\biggr)^k \le \frac{1}{2}.
\]
Rozwiązując tę nierówność ze względu na $k$, otrzymujemy $k\ge\log_{1-1/n}(1/2)$ i~po przyjęciu $n=365$ dostajemy, że najmniejszym całkowitym $k$ spełniającym tę nierówność jest $k=253$.

W~rozwiązaniu drugiej części zadania pozostaniemy przy poprzednim znaczeniu symboli $n$ i~$k$.
Rozważymy zdarzenie komplementarne do szukanego, czyli takie, w~którym co najwyżej jedna osoba ma urodziny 3 maja.
Prawdopodobieństwo, że spośród $k$ osób dokładnie $i$ ma urodziny ustalonego dnia w~roku wynosi
\[
	p_i = \binom{k}{i}\biggl(1-\frac{1}{n}\biggr)^{k-i}
\]
i~stąd
\[
	p_0+p_1 = \biggl(1-\frac{1}{n}\biggr)^k\!+k\biggl(1-\frac{1}{n}\biggr)^{k-1}\!\! = \biggl(1-\frac{1}{n}\biggr)^{k-1}\!\biggl(1-\frac{1}{n}+\frac{m}{n}\biggr) = \biggl(1-\frac{1}{n}\biggr)^{k-1}\!\biggl(1+\frac{m-1}{n}\biggr).
\]
Szukaną wartością jest najmniejsze $k$ spełniające nierówność $p_0+p_1<1/2$.
Dla $n=365$ rozwiązaniem jest $k=613$.

\exercise %5.4-2
Niech $X$ oznacza liczbę potrzebnych rzutów, zanim w~pewnej urnie znajdą się dwie kule.
Załóżmy, że po $k$ rzutach ($k=1$, 2, \dots, $b$) nie było urny z~więcej niż jedną kulą i~obliczmy szanse, że również po $(k+1)$\nbhyphen szym rzucie nie będzie kolizji.
Ponieważ jest zajętych $k$ urn, to $(k+1)$\nbhyphen sza kula wpada do pustej urny z~prawdopodobieństwem równym
\[
	\Pr(X>k+1\mid X>k) = \frac{b-k}{b}.
\]
Zachodzi
\[
	\Pr(X>k+1) = \prod_{i=1}^k\Pr(X>i+1\mid X>i) = \frac{(b-1)(b-2)\dots(b-k)}{b^k}.
\]
Oczywiście $\Pr(X=1)=0$ i~$\Pr(X>1)=1$.
Dla $k=1$, 2, \dots, $b$ mamy
\[
	\Pr(X=k+1) = \Pr(X>k)-\Pr(X>k-1) = \frac{(b-1)(b-2)\dots(b-k+1)k}{b^k} = \frac{b!\,k}{(b-k)!\,b^{k+1}}.
\]

Zajmijmy się teraz wartością oczekiwaną zmiennej losowej $X$:
\begin{align*}
	\E(X) &= \sum_{k=0}^b(k+1)\Pr(X=k+1) \\
	&= \frac{b!}{b^b}\sum_{k=0}^b\frac{b^{b-k}k}{(b-k)!\,b}\,(k+1) \\
	&= \frac{b!}{b^b}\sum_{k=0}^b\frac{b^k(b-k)}{k!\,b}\,(b-k+1) \\
	&= \frac{b!}{b^b}\biggl(\sum_{k=0}^b\frac{b^k}{k!}\,(b-k+1)-\sum_{k=0}^b\frac{b^kk}{k!\,b}\,(b-k+1)\biggr) \\
	&= \frac{b!}{b^b}\biggl(\sum_{k=0}^b\frac{b^k}{k!}\,(b-k+1)-\sum_{k=1}^b\frac{b^{k-1}}{(k-1)!}\,(b-k+1)\biggr) \\
	&= \frac{b!}{b^b}\biggl(\sum_{k=0}^b\frac{b^k}{k!}\,(b-k+1)-\sum_{k=0}^{b-1}\frac{b^k}{k!}\,(b-k)\biggr) \\
	&= \frac{b!}{b^b}\biggl(\sum_{k=0}^b\frac{b^k}{k!}\,(b-k+1)-\sum_{k=0}^b\frac{b^k}{k!}\,(b-k)\biggr) \\
	&= \frac{b!}{b^b}\sum_{k=0}^b\frac{b^k}{k!}.
\end{align*}
Ostatnie wyrażenie jest badane w~\cite{taocp1frag}, gdzie wyprowadzono jego oszacowanie $\sqrt{b\pi/2}+O(1)$, a~zatem $E(X)=\Theta(\!\sqrt{b})$.

\exercise %5.4-3
W~analizie paradoksu dnia urodzin niezależność urodzin wykorzystuje się jedynie we wzorze
\[
    \Pr(b_i=r\;\;\text{i}\;\;b_j=r) = \Pr(b_i=r)\Pr(b_j=r) = 1/n^2.
\]
Wystarczy zatem założenie, że zdarzenia te są parami niezależne.

\exercise %5.4-4
Niech $n$ będzie liczbą dni w~roku.
Oznaczmy przez $P_1(k,n)$ prawdopodobieństwo tego, że wszystkie osoby z~$k$\nbhyphen osobowej grupy mają urodziny w~różne dni, a~$P_2(k,n)$ niech będzie prawdopodobieństwem tego, że pewnego dnia w~roku urodziły się dokładnie dwie osoby z~tej grupy.
Szanse na to, aby wśród tych $k$ osób co najmniej troje miało urodziny tego samego dnia, są równe
\[
	P(k,n) = 1-(P_1(k,n)+P_2(k,n)).
\]
W~klasycznym problemie dnia urodzin zostało wyznaczone
\[
	P_1(k,n) = \frac{n!}{(n-k)!\,n^k} = \frac{k!}{n^k}\binom{n}{k},
\]
pozostaje zatem obliczyć $P_2(k,n)$.

Spośród $n$ dni w~roku wybierzmy jeden, który będzie urodzinami pewnych dwóch osób z~naszej grupy.
Pozostałe $k-2$ osób możemy rozdzielić między $n-1$ dni oznaczających ich urodziny.
Ponieważ rozróżniamy osoby, to liczbę sposobów takiego wyboru należy pomnożyć przez liczbę ich permutacji $k!$ i~podzielić przez 2 z~racji tego, że zmiana kolejności dwóch osób wybranych do tego samego dnia w~roku nie jest odrębnym przypadkiem.
Ale takich par może być więcej.
Można tak naprawdę wybrać $i\le\lfloor k/2\rfloor$ różnych dni, którym przypiszemy pary osób wtedy urodzonych -- liczba możliwości wynosi $\binom{n}{i}$.
Pozostałe osoby rozdzielamy między pozostałe dni w~roku tak, aby każdej przypadł inny dzień, co da się wykonać na $\binom{n-i}{k-2i}$ sposobów.
Podobnie jak wcześniej rozróżnianie osób wprowadza czynnik $k!/2^i$ -- kolejność w~parze w~ramach tego samego dnia jest bowiem nieistotna.
Ponieważ liczba możliwości przypisania $k$ osób do $n$ różnych dni wynosi $n^k$, to ostatecznie otrzymujemy wzór
\[
	P_2(k,n) = \frac{k!}{n^k}\sum_{i=1}^{\lfloor k/2\rfloor}\frac{1}{2^i}\binom{n}{i}\binom{n-i}{k-2i}.
\]

Ustalając wartość $n$ na 365, można teraz obliczyć prawdopodobieństwa $P(k,n)$ dla wszystkich $k=1$, 2, \dots, $n$, po czym wyznaczyć najmniejszą wartość $k$, dla której $P(k,n)\ge1/2$.
Okazuje się, że rozwiązaniem jest $k=88$.

\exercise %5.4-5
Wszystkich możliwych $k$\nbhyphen słów nad zbiorem $n$\nbhyphen elementowym jest $n^k$.
Aby $k$\nbhyphen słowo było w~istocie $k$\nbhyphen permutacją, na pierwszy z~jego elementów należy wybrać jeden z~$n$ elementów zbioru, na drugi element jeden z~$n-1$ dotychczas niewybranych itd.
Istnieje zatem $n(n-1)\dots(n-k+1)$ możliwych $k$\nbhyphen permutacji, więc prawdopodobieństwo, że dane $k$\nbhyphen słowo będzie jedną z~nich wynosi
\[
	\frac{n(n-1)\dots(n-k+1)}{n^k} = \biggl(1-\frac{1}{n}\biggr)\biggl(1-\frac{2}{n}\biggr)\dots\biggl(1-\frac{k-1}{n}\biggr).
\]

Problem jest analogiczny do pytania o~prawdopodobieństwo zdarzenia, że wśród $k$ osób nie ma dwóch takich, które urodziły się tego samego dnia roku, gdzie $n$ jest liczbą dni w~roku.

\exercise %5.4-6
Obliczmy najpierw oczekiwaną liczbę pustych urn.
Niech $S_i$, dla $i=1$, 2, \dots, $n$, będzie zdarzeniem, że $i$\nbhyphen ta urna jest pusta po wykonaniu $n$ rzutów.
Definiujemy zmienną losową $X_i=\I(S_i)$ oraz $X=\sum_{i=1}^nX_i$, która oznacza liczbę pustych urn.
Wtedy
\[
	\E(X) = \E\biggl(\sum_{i=1}^nX_i\biggr) = \sum_{i=1}^n\E(X_i) = \sum_{i=1}^n\Pr(S_i).
\]

Rozważmy teraz $i$\nbhyphen tą urnę i~potraktujmy każdy rzut kulą jako próbę Bernoulliego, gdzie sukcesem jest trafienie do tej urny.
Mamy zatem $n$ niezależnych prób Bernoulliego, każda z~prawdopodobieństwem sukcesu $p=1/n$.
Aby $i$\nbhyphen ta urna pozostała pusta, nie możemy uzyskać żadnego sukcesu, a~zatem korzystając z~rozkładu dwumianowego, dostajemy
\[
	\Pr(S_i) = b(0;n,p) = \binom{n}{0}\biggl(\frac{1}{n}\biggr)^0\biggl(1-\frac{1}{n}\biggr)^n = \biggl(1-\frac{1}{n}\biggr)^n
\]
oraz
\[
	\E(X) = \sum_{i=1}^n\biggl(1-\frac{1}{n}\biggr)^n = n\biggl(1-\frac{1}{n}\biggr)^n.
\]

Wyznaczmy teraz oczekiwaną liczbę urn z~dokładnie jedną kulą.
W~tym celu, podobnie jak poprzednio, dla $i=1$, 2, \dots, $n$ zdefiniujemy zdarzenie $S_i$, że $i$\nbhyphen ta urna po wykonaniu $n$ rzutów zawiera dokładnie jedną kulę.
Definicje zmiennych losowych $X_i$ oraz $X$ pozostają bez zmian i, tak jak poprzednio, zachodzi
\[
	\E(X) = \sum_{i=1}^n\Pr(S_i).
\]
Dla analogicznej serii prób Bernoulliego stwierdzamy, że aby $i$\nbhyphen ta urna zawierała dokładnie jedną kulę, potrzebny jest 1 sukces i~$n-1$ porażek, więc
\[
	\Pr(S_i) = b(1;n,p) = \binom{n}{1}\biggl(\frac{1}{n}\biggr)^1\biggl(1-\frac{1}{n}\biggr)^{n-1} = \biggl(1-\frac{1}{n}\biggr)^{n-1}
\]
oraz
\[
	\E(X) = \sum_{i=1}^n\biggl(1-\frac{1}{n}\biggr)^{n-1} = n\biggl(1-\frac{1}{n}\biggr)^{n-1}.
\]

\exercise %5.4-7
W~zadaniu przyjmujemy, że $n>16$, ponieważ wtedy wyrażenie $\lg n-2\lg\lg n$ jest dodatnie.
Ponadto dla uproszczenia rachunków nie dbamy o~to, aby niektóre liczby były całkowite.

Korzystając z~przedstawionego w~Podręczniku wyprowadzenia, mamy, że prawdopodobieństwo zdarzenia, że ciąg orłów długości co najmniej $\lg n-2\lg\lg n$ rozpoczyna się na pozycji $i$, jest równe
\[
	\Pr(A_{i,\,\lg n-2\lg\lg n}) = \frac{1}{2^{\lg n-2\lg\lg n}} = \frac{2^{2\lg\lg n}}{2^{\lg n}} = \frac{\lg^2n}{n},
\]
a~zatem prawdopodobieństwo, że ciąg orłów o~długości co najmniej $\lg n-2\lg\lg n$ nie rozpoczyna się na pozycji $i$, wynosi
\[
	1-\frac{\lg^2n}{n}.
\]

Podzielmy ciąg $n$ rzutów monetą na $n/(\lg n-2\lg\lg n)$ grup po $\lg n-2\lg\lg n$ kolejnych rzutów każda.
Grupy te złożone są z~różnych i~wzajemnie niezależnych rzutów, a~zatem prawdopodobieństwo, że żadna z~nich nie będzie ciągiem orłów o~długości $\lg n-2\lg\lg n$, wynosi
\begin{align*}
	\biggl(1-\frac{\lg^2n}{n}\biggr)^{n/(\lg n-2\lg\lg n)} &\le \bigl(e^{-(\lg^2n)/n}\bigr)^{n/(\lg n-2\lg\lg n)} \\
	&= e^{-(\lg^2n)/(\lg n-2\lg\lg n)} \\
	&< e^{-\lg n} \\
	&= 1/n.
\end{align*}
Skorzystaliśmy tutaj z~nierówności (3.11) oraz z~tego, że dla $n>16$ zachodzi
\[
	\frac{\lg^2n}{\lg n-2\lg\lg n} > \lg n.
\]
