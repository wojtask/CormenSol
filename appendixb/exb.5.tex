\subchapter{Drzewa}

\exercise %B.5-1
Rys.\ \ref{fig:B.5-1} ilustruje wszystkie szukane drzewa.
\begin{figure}[!ht]
	\centering \input{figb.5-1}
	\caption{{\sffamily\bfseries(a)} Drzewa wolne o~3 wierzchołkach $A$, $B$ i~$C$.
{\sffamily\bfseries(b)} Drzewa ukorzenione o~węzłach $A$, $B$ i~$C$, w~których $A$ jest korzeniem.
{\sffamily\bfseries(c)} Drzewa uporządkowane o~węzłach $A$, $B$ i~$C$, w~których $A$ jest korzeniem.
{\sffamily\bfseries(d)} Drzewa binarne o~węzłach $A$, $B$ i~$C$, w~których $A$ jest korzeniem.} \label{fig:B.5-1}
\end{figure}

\exercise %B.5-2
Przypuśćmy, że twierdzenie jest fałszywe, czyli że wersja nieskierowana grafu $G$ nie tworzy drzewa, a~więc posiada cykl, w~szczególności cykl prosty (\refExercise{B.4-2}).
Niech $\langle v_1,v_2,\dots,v_k,v_1\rangle$ będzie takim cyklem.
Graf $G$ jest acykliczny, zatem dla pewnego $1\le l\le k$ istnieją krawędzie $\langle v_l,v_{l+1}\rangle$, $\langle v_{l+2},v_{l+1}\rangle\in E$, przy czym $v_{k+1}$ utożsamiamy z~$v_1$, a~$v_{k+2}$ z~$v_2$.
Wiemy z~założenia, że $v_0\leadsto v_l$ oraz $v_0\leadsto v_{l+2}$, zatem istnieją dwie różne ścieżki z~$v_0$ do $v_{l+1}$:
\[
	\langle v_0,\dots,v_l,v_{l+1}\rangle \quad\text{oraz}\quad \langle v_0,\dots,v_{l+2},v_{l+1}\rangle.
\]
Otrzymana sprzeczność prowadzi do wniosku, że wersja nieskierowana grafu $G$ jest acykliczna, zatem istotnie stanowi drzewo.

\exercise %B.5-3
Oznaczmy przez $n$, $n_0$, $n_2$, odpowiednio, całkowitą liczbę węzłów niepustego drzewa binarnego, liczbę jego liści oraz liczbę jego węzłów stopnia 2.
Jeśli $n=1$, to drzewo składa się tylko z~korzenia -- mamy więc $n_0=1$, $n_2=0$ i~$n_2=n_0-1$.

Załóżmy, że zależność $n_2=n_0-1$ jest prawdziwa dla dowolnego drzewa binarnego o~rozmiarze $n\ge1$.
Wstawmy do takiego drzewa nowy węzeł jako dodatkowy liść i~rozważmy powstałe drzewo o~rozmiarze $n'=n+1$.
Jeśli nowy węzeł został przyłączony do liścia oryginalnego drzewa, to liczba węzłów stopnia 2 w~nowym drzewie wynosi $n_2'=n_2$, a~liczba liści wynosi $n_0'=n_0$ i~oczywiście zależność $n_2'=n_0'-1$ pozostaje spełniona.
W~przeciwnym razie nowy węzeł został przyłączony do węzła o~stopniu 1.
Wtedy $n_2'=n_2+1$, $n_0'=n_0+1$ i~tu także zachodzi $n_2'=n_0'-1$.

\exercise %B.5-4
Udowodnimy nierówność $h\ge\lfloor\lg n\rfloor$ przez indukcję względem $n$.
Jeśli $n=1$, to drzewo posiada tylko jeden węzeł, więc $h=0$ i~nierówność oczywiście zachodzi.
Załóżmy teraz, że $n\ge2$ oraz że nierówność jest spełniona dla wszystkich drzew binarnych o~$n-1$ węzłach i~wysokości $h$.
Niech $T$ będzie jednym z~nich.
Dodając do niego nowy węzeł, tworzymy nowe drzewo $T'$ o~wysokości $h'$.
Rozważmy dwa przypadki w~zależności od położenia tego węzła w~drzewie $T'$.

Przyjmijmy najpierw, że nowy węzeł został umieszczony na co najwyżej $h$\nbhyphen tym poziomie.
Wówczas $h'=h$.
Jedyny przypadek, gdy nierówność $h'\ge\lfloor\lg n\rfloor$ nie jest spełniona, występuje wówczas, gdy $n=2^{h+1}$, czyli gdy $T$ jest pełnym drzewem binarnym.
Ale każdy poziom takiego drzewa ma komplet węzłów, dlatego nowy węzeł może zostać umieszczony jedynie na $(h+1)$\nbhyphen szym poziomie, co przeczy założeniu.
A~zatem nierówność jest spełniona.

W~przypadku, gdy nowy węzeł zajął w~$T'$ poziom $h+1$, jest $h'=h+1$.
Z~założenia indukcyjnego mamy $h\ge\lfloor\lg(n-1)\rfloor$, zatem wystarczy pokazać, że $\lfloor\lg(n-1)\rfloor+1\ge\lfloor\lg n\rfloor$.
Zauważmy, że dla dowolnej liczby rzeczywistej $x$ i~dowolnej liczby całkowitej $k$ zachodzi $\lfloor x\rfloor+k=\lfloor x+k\rfloor$.
Mamy więc
\[
    \lfloor\lg(n-1)\rfloor+1 = \lfloor\lg(n-1)+1\rfloor = \lfloor\lg(n-1)+\lg2\rfloor = \lfloor\lg(2n-2)\rfloor.
\]
Podłoga oraz logarytm przy podstawie 2 są funkcjami niemalejącymi, a~więc $\lfloor\lg(2n-2)\rfloor\ge\lfloor\lg n\rfloor$, o~ile $2n-2\ge n$, czyli gdy $n\ge2$.
Nierówność zachodzi zatem dla dowolnego drzewa binarnego.

\exercise %B.5-5
Dowodzimy przez indukcję względem $n$.
Gdy $n=0$, to drzewo jest puste, więc $i=e=0$ i~baza zachodzi.
Załóżmy więc, że $n>0$ i~że równanie $e=i+2(n-1)$ jest spełnione przez drzewo regularne o~$n-1$ węzłach wewnętrznych.
W~wyniku dołączenia dwóch nowych węzłów do pewnego liścia, ten staje się węzłem wewnętrznym.
Zwiększamy przez to zarówno liczbę liści, jak i~liczbę węzłów wewnętrznych drzewa o~1.

Zbadajmy, co się dzieje z~długościami ścieżek wewnętrznej i~zewnętrznej po takiej modyfikacji.
Oznaczmy przez $e'$ oraz $i'$, odpowiednio, długość nowej ścieżki zewnętrznej i~długość nowej ścieżki wewnętrznej, a~przez $d$ -- głębokość nowego węzła wewnętrznego.
Zachodzi $e'=e-d+2(d+1)=i+2(n-1)+d+2$ oraz $i'=i+d$, a~zatem $e'=i'+2n$ i~twierdzenie jest spełnione, gdyż teraz w~drzewie jest $n$ węzłów wewnętrznych.

\exercise %B.5-6
Podamy dowód nierówności przez indukcję po liczbie węzłów $n$ drzewa.
W~drzewie pustym ($n=0$) suma wag liści wynosi 0, co oczywiście spełnia nierówność.
Gdy $n=1$, to drzewo składa się z~jednego liścia o~głębokości 0, więc suma wag liści wynosi $2^{-0}=1$.

Załóżmy, że $n>1$ i~że nierówność zachodzi dla drzew o~co najwyżej $n-1$ węzłach.
Niech $T$ będzie drzewem binarnym o~$n$ węzłach, a~$T_L$, $T_R$ -- odpowiednio -- jego lewym i~prawym poddrzewem.
Z~założenia indukcyjnego mamy, że nierówność jest spełniona osobno dla drzew $T_L$ i~$T_R$.
Głębokości liści drzewa $T$ są o~1 większe od głębokości tych samych liści w~$T_L$ i~$T_R$, stąd wagi liści $T$ są o~połowę mniejsze w~porównaniu z~wagami tych samych liści w~tych poddrzewach.
Zatem w~drzewie $T$ sumy wag liści zarówno z~$T_L$, jak i~$T_R$, nie przekraczają $1/2$, a~więc łączna suma wag liści w~$T$ nie przekracza 1.

\exercise %B.5-7
\note{W~tekście zadania występuje błąd.
Twierdzenie nie zachodzi bowiem dla drzew o~jednym liściu, dlatego w~rozwiązaniu zakładamy, że\/ $L\ge2$.}

\noindent Niech $T$ będzie drzewem binarnym o~$L\ge2$ liściach.
Założymy nie wprost, że w~$T$ nie ma poddrzewa mające między $L/3$ a~$2L/3$ liści włącznie.
Ponieważ $L\ge2$, to korzeń $T$ nie jest liściem.
Będziemy podążać ścieżką od korzenia do liścia, w~każdym kroku przechodząc z~węzła do jego syna, w~którego poddrzewie jest więcej liści.
Liczba liści poddrzewa o~korzeniu w~aktualnym węźle na tej ścieżce zmniejsza się od $L$ do 1.
Na podstawie założenia, na ścieżce istnieje węzeł $x$, mający w~swoim poddrzewie więcej niż $2L/3$ liści, oraz jego syn $y$ o~mniej niż $L/3$ liściach w~swoim poddrzewie.
Drugi syn węzła $x$ ma mniej potomnych liści niż $y$ (0, jeśli nie istnieje), a~to prowadzi do sprzeczności, bo suma potomnych liści synów węzła $x$ jest mniejsza niż $2L/3$.
