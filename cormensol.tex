\documentclass[a4paper,10pt,twoside,openany,titlepage]{book}
\usepackage[MeX,plmath]{polski}
\usepackage[utf8]{inputenc}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{epsf}
\usepackage[pdftex]{graphicx}
\usepackage{geometry}
\usepackage{clrscode}
\usepackage{url}
\usepackage{tocloft}
\usepackage[font=small,format=plain,labelfont=sf,bf,up]{caption}
\usepackage[pdfborder={0 0 0},pdftex,bookmarks=true,hypertexnames=false,unicode=true]{hyperref}
\usepackage{todonotes}
\usepackage{cormensol}

% po to, aby notki z todonotes nie wychodziły poza margines
\setlength{\marginparwidth}{3.5cm}

% zapobiega pojawianiu się dziwnych znaków w zakładkach PDFowych
\hypersetup{pdfencoding=auto}

% decyduje, jak chętnie będą łamane wielowierszowe bloki
\allowdisplaybreaks[1]

\begin{document}

\frontmatter

\include{title}
\include{intro}

\ifpdf
	\addtocontents{toc}{\protect\pdfbookmark{Spis treści}{Tableofcont}}
\fi
\tableofcontents

% redefinicja rozdziału, która przywraca styl licznika subsekcji na styl numerów zadań
% i przywraca nazwę podrozdziału na żywej paginie
% musi być po \include{intro} bo intro używa zwykłego polecenia \chapter
\let\mychapter=\chapter
\renewcommand{\chapter}[1]{%
	\mychapter{#1}
	\setcounter{subsection}{0}
	\def\thesubsection{\thechapter.\arabic{section}-\arabic{subsection}}
	\lhead[\fancyplain{}{\small\sffamily\bfseries\thepage}]{\fancyplain{}{\small\sffamily\bfseries\rightmark}}
}

\mainmatter

\part{Podstawy}

\include{ch01}
\setcounter{chapter}{1}
\include{ch02}
\setcounter{chapter}{2}
\include{ch03}
\setcounter{chapter}{3}
\setcounter{figure}{2}
\include{ch04}
\setcounter{chapter}{4}
\setcounter{figure}{7}
\include{ch05}

\setcounter{part}{1}
\part{Sortowanie i~statystyki pozycyjne}

\setcounter{chapter}{5}
\setcounter{figure}{7}
\include{ch06}
\setcounter{chapter}{6}
\setcounter{figure}{13}
\include{ch07}
\setcounter{chapter}{7}
\setcounter{figure}{15}
\include{ch08}
\setcounter{chapter}{8}
\setcounter{figure}{18}
\include{ch09}

% \setcounter{part}{2}
% \part{Struktury danych}
% 
% \setcounter{chapter}{9}
% \setcounter{figure}{18}
% \include{ch10}
% \include{ch11}
% \include{ch12}
% \include{ch13}
% \include{ch14}
% 
% \part{Zaawansowane metody konstruowania i~analizowania algorytmów}
% 
% \setcounter{chapter}{14}
% \include{ch15}
% \include{ch16}
% \include{ch17}
% 
% \part{Złożone struktury danych}
% 
% \setcounter{chapter}{17}
% \include{ch18}
% \include{ch19}
% \include{ch20}
% \include{ch21}
% 
% \part{Algorytmy grafowe}
% 
% \setcounter{chapter}{21}
% \include{ch22}
% \include{ch23}
% \include{ch24}
% \include{ch25}
% \include{ch26}
% 
% \part{Wybrane zagadnienia}
% 
% \setcounter{chapter}{26}
% \include{ch27}
% \include{ch28}
% \include{ch29}
% \include{ch30}
% \include{ch31}
% \include{ch32}
% \include{ch33}
% \include{ch34}
% \include{ch35}

\setcounter{part}{7}
\part{Dodatek: Podstawy matematyczne}

\appendix
\makeatletter
	\@appendixtrue
\makeatother

\include{appa}
\setcounter{chapter}{1}
\setcounter{figure}{99} % dla potrzeb testowych, czy dobrze wygląda z trzycyfrowymi numerami rysunków
\include{appb}
\setcounter{chapter}{2}
\setcounter{figure}{105}
\include{appc}

\backmatter

\let\chapter=\mychapter

\bibliographystyle{plplain}
\bibliography{cormensol}
\nocite{*}

\end{document}
