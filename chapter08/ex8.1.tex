\subchapter{Dolne ograniczenia dla problemu sortowania}

\exercise %8.1-1
Rozważmy $n$\nbhyphen elementowy ciąg wejściowy $\langle a_1,a_2,\dots,a_n\rangle$.
Jeśli w~szczególności ciąg byłby uporządkowany rosnąco, to w~celu stwierdzenia tego faktu należałoby porównać elementy w~każdej parze postaci $\langle a_i,a_{i+1}\rangle$ dla $i=1$, 2, \dots, $n-1$, czyli wykonać co najmniej $n-1$ porównań.
Dopóki dana para elementów nie jest porównana, dopóty nie jest znana informacja o~wzajemnej kolejności elementów z~tej pary.

Stąd najmniejszą głębokością liścia w~drzewie decyzyjnym dla ciągu $n$\nbhyphen elementowego jest $n-1$.

\exercise %8.1-2
Oszacowanie górne:
\[
	\lg(n!) = \sum_{k=1}^n\lg k \le \sum_{k=1}^n\lg n = n\lg n = O(n\lg n).
\]
Oszacowanie dolne:
\[
	\lg(n!) = \sum_{k=1}^n\lg k \ge \sum_{k=\lceil n/2\rceil}^n\lg k \ge \sum_{k=\lceil n/2\rceil}^n\lg\lceil n/2\rceil \ge \lfloor n/2\rfloor\lg\lceil n/2\rceil = \Omega(n\lg n).
\]

\exercise %8.1-3
Jeśli sortowanie działa w~czasie $\Theta(n)$ dla $l$ permutacji wejściowych długości $n$, to drzewo decyzyjne składające się z~gałęzi odpowiadających tylko tym permutacjom, ma wysokość $h=\Theta(n)$.
Powtarzając rozumowanie z~dowodu tw.\ 8.1, dostajemy nierówność $2^h\ge l$, a~stąd $h\ge\lg l$.
Pozostaje więc sprawdzić, czy $h$ jest asymptotycznie ograniczone funkcją liniową względem $n$ dla poszczególnych wartości przyjmowanych przez $l$:
\begin{itemize}
	\item jeśli $l=n!/2$, to $h\ge\lg l=\lg(n!/2)=\lg(n!)-1=\Omega(n\lg n)$;
	\item jeśli $l=n!/n$, to $h\ge\lg l=\lg(n!/n)=\lg(n!)-\lg n=\Omega(n\lg n)$;
	\item jeśli $l=n!/2^n$, to $h\ge\lg l=\lg(n!/2^n)=\lg(n!)-n=\Omega(n\lg n)$.
\end{itemize}
W~każdym badanym przypadku $h=\Omega(n\lg n)$, zatem nie istnieje algorytm sortujący za pomocą porównań i~działający w~czasie liniowym dla poszczególnych ilości permutacji wejściowych.

\exercise %8.1-4
Rozważmy drzewo decyzyjne reprezentujące sortowanie takiego częściowo uporządkowanego ciągu.
Każdy podciąg może wystąpić na wyjściu jako jedna z~$k!$ możliwych permutacji.
Ponieważ jest $n/k$ podciągów, to w~drzewie decyzyjnym znajduje się co najmniej $(k!)^{n/k}$ osiągalnych liści.
Na mocy faktu, że drzewo decyzyjne o~wysokości $h$ nie może mieć więcej niż $2^h$ liści, dostajemy
\[
	2^h \ge (k!)^{n/k},
\]
skąd uzyskujemy dolne oszacowanie na ilość porównań wykonywanych w~tym algorytmie:
\[
	h \ge \lg\bigl((k!)^{n/k}\bigr) = (n/k)\lg(k!) = (n/k)\cdot\Omega(k\lg k) = \Omega(n\lg k).
\]
